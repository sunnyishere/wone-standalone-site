# 独立站独立部署

## 项目概述

网站静态化部署服务，主要通过请求品牌商服务接口完成相关网站页面的静态化本地存储，或实时请求转发。

## 核心功能

- **静态页面生成与存储**：自动从品牌商服务接口获取页面内容并生成静态HTML文件
- **实时请求转发**：访问未静态化页面时，自动转发请求并同步静态化
- **定时任务更新**：支持定时自动刷新所有静态页面
- **应用启动自动生成**：支持应用启动时自动生成静态页面

## 技术栈

- **后端框架**：Spring Boot 2.6.13
- **开发语言**：Java 8
- **前端服务器**：Nginx
- **页面解析**：Jsoup 1.10.2
- **构建工具**：Maven


## 核心组件说明

### 1. StaticPageService

静态页面生成服务，负责从品牌商服务获取内容并生成静态HTML文件。

### 2. RockwillKnowledgeService

品牌商服务接口请求服务，负责与远程品牌商服务API交互获取数据。

### 3. UnifiedRouterController

统一路由控制器，处理未静态化页面的请求转发和实时静态化。

### 4. StaticPageScheduler

静态页面定时任务调度器，每日凌晨2点自动生成所有静态页面。


## Nginx配置

Nginx配置文件位于 `nginx/server.conf`，主要功能包括：

- 监听80端口
- 设置静态文件根目录
- 处理静态资源请求（CSS、JS、图片等）
- 对未找到的静态页面请求转发到Spring Boot应用（8080端口）

## 配置说明

### 主要配置项

- **brand.domain**: 独立部署对应域名
- **brand.static-output**：静态页面输出路径，默认值为`${user.dir}/static-output`
- **brand.scheduler-enable**：是否启用定时任务，默认值为true
- **brand.execute-on-start**：是否在应用启动时执行静态页面生成，默认值为true


### 页面类型支持

支持以下页面类型：
- 首页（Home）
- 产品（Products）
- 解决方案（Solutions）
- 文档（Documents）
- 新闻（News）
- 公司简介（Profile）


## 工作流程

1. **静态页面生成流程**：
   - 定时任务或手动触发静态页面生成
   - 从品牌商API获取页面内容
   - 处理并保存为静态HTML文件

2. **请求处理流程**：
   - 客户端请求访问页面
   - Nginx尝试提供静态文件
   - 若静态文件不存在，转发请求到Spring Boot应用
   - 应用从品牌商API获取内容并返回给客户端
   - 同时将内容保存为静态文件，供后续请求使用

## 注意事项

- 确保Nginx配置中的静态文件路径与应用配置一致
- 首次部署时，建议手动触发一次静态页面生成
